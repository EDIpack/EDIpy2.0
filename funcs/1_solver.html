

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Impurity Problem Initialization, Solution and Finalization &mdash; EDIpack2py 5.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=aface3f9" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=ce74c6a2"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bath Manipulation" href="2_bath.html" />
    <link rel="prev" title="Input file manipulation" href="0_readinput.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EDIpack2py
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pyinstallation.html">EDIpack2py Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pyinstallation.html#anaconda">Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyinstallation.html#install-with-pip">Install with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyinstallation.html#install-from-source">Install from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basicusage.html">Basic usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basicusage.html#module-import">Module import</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basicusage.html#minimal-dmft-loop">Minimal DMFT loop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../globvars.html">Global variables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.beta"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.beta</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Jh"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Jh</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.dmft_error"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.dmft_error</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.ed_total_ud"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.ed_total_ud</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.ed_twin"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.ed_twin</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.eps"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.eps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Jx"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Jx</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Jp"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Jp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Lmats"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Lmats</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.LOGfile"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.LOGfile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Lpos"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Lpos</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Lreal"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Lreal</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Ltau"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Ltau</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Nbath"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Nbath</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Nloop"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Nloop</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Norb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Nph"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Nph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.nread"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.nread</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Nspin</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Nsuccess"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Nsuccess</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.sb_field"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.sb_field</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Uloc"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Uloc</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.Ust"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.Ust</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.wini"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.wini</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.wfin"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.wfin</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.xmin"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.xmin</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.xmax"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.xmax</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../globvars.html#edipack2py.global_env.xmu"><code class="docutils literal notranslate"><span class="pre">edipack2py.global_env.xmu</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">Functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0_readinput.html">Input file manipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0_readinput.html#edipack2py.global_env.read_input"><code class="docutils literal notranslate"><span class="pre">read_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Impurity Problem Initialization, Solution and Finalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#edipack2py.global_env.finalize_solver"><code class="docutils literal notranslate"><span class="pre">finalize_solver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#edipack2py.global_env.init_solver"><code class="docutils literal notranslate"><span class="pre">init_solver()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#edipack2py.global_env.set_hloc"><code class="docutils literal notranslate"><span class="pre">set_hloc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#edipack2py.global_env.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_bath.html">Bath Manipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.bath_inspect"><code class="docutils literal notranslate"><span class="pre">bath_inspect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.break_symmetry_bath"><code class="docutils literal notranslate"><span class="pre">break_symmetry_bath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.chi2_fitgf"><code class="docutils literal notranslate"><span class="pre">chi2_fitgf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension"><code class="docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.orb_equality_bath"><code class="docutils literal notranslate"><span class="pre">orb_equality_bath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.orb_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">orb_symmetrize_bath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.ph_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">ph_symmetrize_bath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.save_array_as_bath"><code class="docutils literal notranslate"><span class="pre">save_array_as_bath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.set_hgeneral"><code class="docutils literal notranslate"><span class="pre">set_hgeneral()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.set_hreplica"><code class="docutils literal notranslate"><span class="pre">set_hreplica()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="2_bath.html#edipack2py.global_env.spin_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">spin_symmetrize_bath()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3_inputoutput.html">Input / Output Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_dens"><code class="docutils literal notranslate"><span class="pre">get_dens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_docc"><code class="docutils literal notranslate"><span class="pre">get_docc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_eimp"><code class="docutils literal notranslate"><span class="pre">get_eimp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_mag"><code class="docutils literal notranslate"><span class="pre">get_mag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_phi"><code class="docutils literal notranslate"><span class="pre">get_phi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_gimp"><code class="docutils literal notranslate"><span class="pre">get_gimp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_sigma"><code class="docutils literal notranslate"><span class="pre">get_sigma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_g0and"><code class="docutils literal notranslate"><span class="pre">get_g0and()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_delta"><code class="docutils literal notranslate"><span class="pre">get_delta()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_chi"><code class="docutils literal notranslate"><span class="pre">get_chi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="3_inputoutput.html#edipack2py.global_env.get_impurity_rdm"><code class="docutils literal notranslate"><span class="pre">get_impurity_rdm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4_auxiliary.html">Auxiliary procedures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="4_auxiliary.html#edipack2py.global_env.check_convergence"><code class="docutils literal notranslate"><span class="pre">check_convergence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="4_auxiliary.html#edipack2py.global_env.get_bath_type"><code class="docutils literal notranslate"><span class="pre">get_bath_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="4_auxiliary.html#edipack2py.global_env.get_ed_mode"><code class="docutils literal notranslate"><span class="pre">get_ed_mode()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="4_auxiliary.html#edipack2py.global_env.search_variable"><code class="docutils literal notranslate"><span class="pre">search_variable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="5_interaction_matrix_parsing.html">Interaction matrix parsing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="5_interaction_matrix_parsing.html#edipack2py.global_env.add_twobody_operator"><code class="docutils literal notranslate"><span class="pre">add_twobody_operator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="5_interaction_matrix_parsing.html#edipack2py.global_env.reset_umatrix"><code class="docutils literal notranslate"><span class="pre">reset_umatrix()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TRIQS compatibility layer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../edipack2triqs.html">TRIQS compatibility layer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/edipack/EDIpack2py">EDIpack2py on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/edipack/EDIpack">EDIpack on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SciFortran/SciFortran">SciFortran on GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EDIpack2py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../functions.html">Functions</a></li>
      <li class="breadcrumb-item active">Impurity Problem Initialization, Solution and Finalization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/funcs/1_solver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="0_readinput.html" class="btn btn-neutral float-left" title="Input file manipulation" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_bath.html" class="btn btn-neutral float-right" title="Bath Manipulation" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="impurity-problem-initialization-solution-and-finalization">
<span id="solver"></span><h1>Impurity Problem Initialization, Solution and Finalization<a class="headerlink" href="#impurity-problem-initialization-solution-and-finalization" title="Link to this heading"></a></h1>
<p>These functions initialize, solve and finalize the impurity problem. They can be invoked inside or outside the DMFT loop. The solution environment can be completely reconstructed from the bath parameters array and the global variables.</p>
<dl class="py function">
<dt class="sig sig-object py" id="edipack2py.global_env.finalize_solver">
<span class="sig-prename descclassname"><span class="pre">edipack2py.global_env.</span></span><span class="sig-name descname"><span class="pre">finalize_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/edipack2py/func_main.html#finalize_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#edipack2py.global_env.finalize_solver" title="Link to this definition"></a></dt>
<dd><p>This function cleans up the ED environment, deallocates the relevant        arrays and makes a second call to <strong class="command">init_solver</strong> possible</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nothing</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edipack2py.global_env.init_solver">
<span class="sig-prename descclassname"><span class="pre">edipack2py.global_env.</span></span><span class="sig-name descname"><span class="pre">init_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nlat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/edipack2py/func_main.html#init_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#edipack2py.global_env.init_solver" title="Link to this definition"></a></dt>
<dd><p>This function initializes the ED environment for the impurity problem        solution, and sets the bath reading it from the <code class="docutils literal notranslate"><span class="pre">hamiltonian.restart</span></code>       file or initializing it in a symmetric way.
The function can take different argument combinations.</p>
<p>If no input is provided, a single-impurity bath is allocated, with        dimension given by <a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension" title="edipack2py.global_env.get_bath_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a>. If <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nbath" title="edipack2py.global_env.Nbath"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nbath</span></code></a> is <code class="docutils literal notranslate"><span class="pre">0</span></code>        the solver will be initialized for an isolated impurity, and the function        will return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bath</strong> (np.array(dtype=float) <strong>or</strong> [float]) – If a bath array is provided, it has to be a numpy array        or a tuple of floats. It has to have one or two dimensions. If it has        one dimension, that must be the same as specified by <a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension" title="edipack2py.global_env.get_bath_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a>.        If it has two dimensions, the first has to be the number of inequivalent        sites for real-space DMFT, the second must be in agreement with        <a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension" title="edipack2py.global_env.get_bath_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">Nlat</span></code> or <code class="docutils literal notranslate"><span class="pre">Nb</span></code> are provided,        this overrides them. If the provided vector is not in agreement        with the global system parameters, EDIpack2 will exit with an error.
The array is ordered in F convention inside the function.</p></li>
<li><p><strong>Nb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – This sets the bath vector length for each single impurity        problem. It has to be in agreement with <a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension" title="edipack2py.global_env.get_bath_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a>.        When this parameter alone is provided, a numpy array of this length        will be initialized.</p></li>
<li><p><strong>Nlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – This sets the number of inequivalent sites for        real-space DMFT. If this parameter alone is provided,        <a class="reference internal" href="2_bath.html#edipack2py.global_env.get_bath_dimension" title="edipack2py.global_env.get_bath_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a> is invoked to determine the bath vector        length Nb for each impurity. A <code class="docutils literal notranslate"><span class="pre">[Nlat,Nb]</span></code> vector is then allocated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of floats that contains the bath parameters for the        impurity problem. This is a required input of <a class="reference internal" href="#edipack2py.global_env.solve" title="edipack2py.global_env.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve()</span></code></a> and        <a class="reference internal" href="2_bath.html#edipack2py.global_env.chi2_fitgf" title="edipack2py.global_env.chi2_fitgf"><code class="xref py py-func docutils literal notranslate"><span class="pre">chi2_fitgf()</span></code></a>. Its elements are ordered differently depending        on the bath geometry. They are (de)compactified for user interaction        via <a class="reference internal" href="2_bath.html#edipack2py.global_env.bath_inspect" title="edipack2py.global_env.bath_inspect"><code class="xref py py-func docutils literal notranslate"><span class="pre">bath_inspect()</span></code></a>. Specific symmetrization operations are        implemented and listed in the <a class="reference internal" href="2_bath.html#bath"><span class="std std-ref">Bath Manipulation</span></a> section.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array(dtype=float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edipack2py.global_env.set_hloc">
<span class="sig-prename descclassname"><span class="pre">edipack2py.global_env.</span></span><span class="sig-name descname"><span class="pre">set_hloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nlat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/edipack2py/func_aux_funx.html#set_hloc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#edipack2py.global_env.set_hloc" title="Link to this definition"></a></dt>
<dd><p>This function sets the local Hamiltonian of the impurity problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hloc</strong> (<em>np.array</em><em>(</em><em>dtype=complex</em><em>)</em>) – <p>Local Hamiltonian matrix. This can have the following shapes:</p>
<ul>
<li><p>[ <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a>        <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ]: single-impurity case, 2-dimensional array</p></li>
<li><p>[ <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ]:        single-impurity case, 4-dimensional array</p></li>
<li><p>[ <code class="code docutils literal notranslate"><span class="pre">Nlat</span></code> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ,        <code class="code docutils literal notranslate"><span class="pre">Nlat</span></code> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ]:        real-space DMFT case, 2-dimensional array.</p></li>
<li><p>[ <code class="code docutils literal notranslate"><span class="pre">Nlat</span></code> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a>       <span class="math notranslate nohighlight">\(\cdot\)</span> <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ]: single-impurity case, 3-dimensional array.</p></li>
<li><p>[ <code class="code docutils literal notranslate"><span class="pre">Nlat</span></code> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nspin" title="edipack2py.global_env.Nspin"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nspin</span></code></a> , <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ,         <a class="reference internal" href="../globvars.html#edipack2py.global_env.Norb" title="edipack2py.global_env.Norb"><code class="xref py py-data docutils literal notranslate"><span class="pre">Norb</span></code></a> ]: single-impurity case, 5-dimensional array.</p></li>
</ul>
<p>The array is ordered in F convention inside the function.</p>
<p><strong>Note</strong>: the way the EDIpack library passes from 1 comulative to 2 or 3                running indices is, from slower to faster: <code class="docutils literal notranslate"><span class="pre">lat</span></code>, <code class="docutils literal notranslate"><span class="pre">spin</span></code>, <code class="docutils literal notranslate"><span class="pre">orb</span></code></p>
</p></li>
<li><p><strong>Nlat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of inequivalent sites for real-space DMFT. The function      will raise a ValueError if the dimensions of <code class="docutils literal notranslate"><span class="pre">hloc</span></code> are inconsistent with      the presence or absence of Nlat. The EDIpack library will check the      correctness of the dimensions of <code class="docutils literal notranslate"><span class="pre">hloc</span></code> and terminate execution if inconsistent.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If hloc is not provided or has the wrong shape</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nothing</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edipack2py.global_env.solve">
<span class="sig-prename descclassname"><span class="pre">edipack2py.global_env.</span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_mpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_lanc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/edipack2py/func_main.html#solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#edipack2py.global_env.solve" title="Link to this definition"></a></dt>
<dd><p>This function solves the impurity problem and calculates the        observables, Green’s function and self-energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bath</strong> (<em>np.array</em><em>(</em><em>dtype=float</em><em>)</em>) – The bath array returned by  <a class="reference internal" href="#edipack2py.global_env.init_solver" title="edipack2py.global_env.init_solver"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_solver()</span></code></a>.        If the bath dimensions are inconsistent with the global properties        of the problem, EDIpack will exit with an error. If no bath is provided        the code will diagonalize the isolated impurity Hamiltonian. In this case        if <a class="reference internal" href="../globvars.html#edipack2py.global_env.Nbath" title="edipack2py.global_env.Nbath"><code class="xref py py-data docutils literal notranslate"><span class="pre">Nbath</span></code></a> is not <code class="docutils literal notranslate"><span class="pre">0</span></code> the code will raise a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p></li>
<li><p><strong>flag_gf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – for single-impurity DMFT, if <code class="code docutils literal notranslate"><span class="pre">False</span></code>, it disables        the calculation of the Green’s function and susceptibilities</p></li>
<li><p><strong>flag_mpi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <code class="code docutils literal notranslate"><span class="pre">False</span></code>, for single-impurity DMFT, it disables        MPI for the ED routine, if the communicator is used elsewhere</p></li>
<li><p><strong>mpi_lanc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <code class="code docutils literal notranslate"><span class="pre">True</span></code>, for real-space DMFT sets the MPI        parallelization for the ED routine. By default it is <code class="code docutils literal notranslate"><span class="pre">False</span></code>,        and each inequivalent site is solved serially by a different core.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0_readinput.html" class="btn btn-neutral float-left" title="Input file manipulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_bath.html" class="btn btn-neutral float-right" title="Bath Manipulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Lorenzo Crippa and Adriano Amaricci.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>